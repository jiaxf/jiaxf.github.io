<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>飞天雪的技术博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="jiaxf&apos;s blog | js | node | javascript">
<meta property="og:type" content="website">
<meta property="og:title" content="飞天雪的技术博客">
<meta property="og:url" content="http://jiaxf.github.io/index.html">
<meta property="og:site_name" content="飞天雪的技术博客">
<meta property="og:description" content="jiaxf&apos;s blog | js | node | javascript">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="飞天雪的技术博客">
<meta name="twitter:description" content="jiaxf&apos;s blog | js | node | javascript">
  
    <link rel="alternative" href="/atom.xml" title="飞天雪的技术博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/linux.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="jiaxf欢迎您来访！">Jiaxf</a></h1>
        </hgroup>

        
        <p class="header-subtitle">技术无止境</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="search" placeholder=" Search...">
            </form>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/archives">技术文摘</a></li>
                        
                            <li><a href="/works">前端集锦</a></li>
                        
                            <li><a href="/readings">阅读书单</a></li>
                        
                            <li><a href="/about">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:jiaxuefeng0@gmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/jiaxf" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="https://zhihu.com/people/jia-xue-feng-0" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/jiaxuefeng" title="weibo">weibo</a>
                            
                                <a class="fl linkedin" target="_blank" href="http://cn.linkedin.com/in/jiaxuefeng" title="linkedin">linkedin</a>
                            
                                <a class="fl rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                                <a class="fl douban" target="_blank" href="https://www.douban.com/people/54387876/" title="douban">douban</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Base64/" style="font-size: 10px;">Base64</a> <a href="/tags/Let-s-Encrypt/" style="font-size: 10px;">Let's Encrypt</a> <a href="/tags/R/" style="font-size: 12px;">R</a> <a href="/tags/css3/" style="font-size: 10px;">css3</a> <a href="/tags/event/" style="font-size: 10px;">event</a> <a href="/tags/functional/" style="font-size: 18px;">functional</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/http/" style="font-size: 11px;">http</a> <a href="/tags/https/" style="font-size: 13px;">https</a> <a href="/tags/java/" style="font-size: 11px;">java</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/js/" style="font-size: 16px;">js</a> <a href="/tags/jsx/" style="font-size: 10px;">jsx</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/md5/" style="font-size: 10px;">md5</a> <a href="/tags/mysql/" style="font-size: 11px;">mysql</a> <a href="/tags/node/" style="font-size: 11px;">node</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/pattern/" style="font-size: 10px;">pattern</a> <a href="/tags/php/" style="font-size: 11px;">php</a> <a href="/tags/ramda/" style="font-size: 17px;">ramda</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/spring/" style="font-size: 11px;">spring</a> <a href="/tags/web/" style="font-size: 13px;">web</a> <a href="/tags/函数式编程/" style="font-size: 14px;">函数式编程</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/加密/" style="font-size: 11px;">加密</a> <a href="/tags/区块链/" style="font-size: 10px;">区块链</a> <a href="/tags/技术/" style="font-size: 19px;">技术</a> <a href="/tags/服务器/" style="font-size: 10px;">服务器</a> <a href="/tags/生活乐趣/" style="font-size: 10px;">生活乐趣</a> <a href="/tags/算法/" style="font-size: 11px;">算法</a> <a href="/tags/缓存/" style="font-size: 14px;">缓存</a> <a href="/tags/解密/" style="font-size: 11px;">解密</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://luuman.github.io/">luuman</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">码农一枚，追求极客！</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
<script type="text/javascript">(function(){document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E'));var bdcs = document.createElement('script');bdcs.type = 'text/javascript';bdcs.async = true;bdcs.src = 'http://znsv.baidu.com/customer_search/api/js?sid=13578845068435931330' + '&plate_url=' + encodeURIComponent(window.location.href) + '&t=' + Math.ceil(new Date()/3600000);var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(bdcs, s);})();</script>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">Jiaxf</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/linux.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">Jiaxf</a></h1>
            </hgroup>
            
            <p class="header-subtitle">技术无止境</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/archives">技术文摘</a></li>
                
                    <li><a href="/works">前端集锦</a></li>
                
                    <li><a href="/readings">阅读书单</a></li>
                
                    <li><a href="/about">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:jiaxuefeng0@gmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/jiaxf" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://zhihu.com/people/jia-xue-feng-0" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/jiaxuefeng" title="weibo">weibo</a>
                    
                        <a class="linkedin" target="_blank" href="http://cn.linkedin.com/in/jiaxuefeng" title="linkedin">linkedin</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                        <a class="douban" target="_blank" href="https://www.douban.com/people/54387876/" title="douban">douban</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-https请求过程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/10/11/https请求过程/" class="article-date">
      <time datetime="2019-10-11T01:39:18.000Z" itemprop="datePublished">2019-10-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/11/https请求过程/">https请求过程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="HTTP与HTTPS的不同点："><a href="#HTTP与HTTPS的不同点：" class="headerlink" title="HTTP与HTTPS的不同点："></a>HTTP与HTTPS的不同点：</h1><ul>
<li>1、HTTPS需要用到CA申请证书。</li>
<li>2、HTTP是超文本传输协议，信息是明文的；HTTPS则是具有安全性的SSL加密传输协议。</li>
<li>3、HTTPS和HTTP使用的是完全不同的连接方式，用的端口也不一样，HTTP是80,HTTPS是443。</li>
<li>4、HTTP的连接很简单，是无状态的，HTTPS是HTTP+SSL协议构建的，可进行加密传输、身份认证的网络协议，比HTTP协议安全。</li>
</ul>
<h1 id="HTTPS的优势"><a href="#HTTPS的优势" class="headerlink" title="HTTPS的优势"></a>HTTPS的优势</h1><ul>
<li>1、内容加密，建立一个信息的安全通道，来保证数据传输过程的安全性。</li>
<li>2、身份认证，确认网站的真是性。</li>
<li>3、数据完整性，防止内容被第三方冒充或者篡改。</li>
</ul>
<h1 id="HTTPS请求过程"><a href="#HTTPS请求过程" class="headerlink" title="HTTPS请求过程"></a>HTTPS请求过程</h1><p>HTTPS协议的本质就是HTTP + SSL(or TLS)。在HTTP报文进入TCP报文之前，先使用SSL对HTTP报文进行加密。从网络的层级结构看它位于HTTP协议与TCP协议之间。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">SSL</span><span class="params">(Secure Sokcet Layer，安全套接字层)</span></span></span><br><span class="line"><span class="function"><span class="title">TLS</span><span class="params">(Transport Layer Security,传输层安全协议)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="/img/http&amp;https.png" alt=""></p>
<p>HTTPS在传输数据之前需要客户端与服务器进行一个握手(TLS/SSL握手)，在握手过程中将确立双方加密传输数据的密码信息。</p>
<p><img src="/img/https过程.png" alt=""></p>
<pre><code>1、浏览器发起往服务器的 443 端口发起请求，请求携带了浏览器支持的加密算法和哈希算法。
2、服务器收到请求，选择浏览器支持的加密算法和哈希算法。
3、服务器下将数字证书返回给浏览器，这里的数字证书可以是向某个可靠机构申请的，也可以是自制的。
    （注释：证书包括以下这些内容：1. 证书序列号。2. 证书过期时间。3. 站点组织名。4. 站点DNS主机名。5. 站点公钥。6. 证书颁发者名。7. 证书签名。因为证书是要给大家用的，所以不需要加密传输）
4、浏览器进入数字证书认证环节，这一部分是浏览器内置的 TSL 完成的：
    4.1 首先浏览器会从内置的证书列表中索引，找到服务器下发证书对应的机构，如果没有找到，此时就会提示用户该证书是不是由权威机构颁发，是不可信任的。如果查到了对应的机构，则取出该机构颁发的公钥。
    4.2 用机构的证书公钥解密得到证书的内容和证书签名，内容包括网站的网址、网站的公钥、证书的有效期等。浏览器会先验证证书签名的合法性（验证过程类似上面 Bob 和 Susan 的通信）。
    签名通过后，浏览器验证证书记录的网址是否和当前网址是一致的，不一致会提示用户。如果网址一致会检查证书有效期，证书过期了也会提示用户。这些都通过认证时，浏览器就可以安全使用证书中的网站公钥了。
    4.3 浏览器生成一个随机数 R，并使用网站公钥对 R 进行加密。
5、浏览器将加密的 R 传送给服务器。
6、服务器用自己的私钥解密得到 R。
7、服务器以 R 为密钥使用了对称加密算法加密网页内容并传输给浏览器。
8、浏览器以 R 为密钥使用之前约定好的解密算法获取网页内容。
</code></pre><blockquote>
<p>数字证书如何认证？<br>首先你的证书会在https握手过程中被传递到浏览器，浏览器从你的证书中找到了颁发者，从颁发者的证书（如果你电脑上有的话）又找到了CA的证书<br>（CA证书会在操作系统安装时就安装好，所以每个人电脑上都有根证书），使用CA证书中带的公钥来对颁发者证书做验签，一旦匹配，说明你电脑上的颁发者证书不是伪造的，<br>同理，再用颁发者证书中的公钥去验证你的证书，&gt; 以此证明你的证书不是伪造的。这样整个链状的验证，从而确保你的证书一定是直接或间接从CA签发的，<br>这样浏览器地址栏会显示一个绿色的盾牌，表示你的网站能通过证书验证<br>如果你的电脑上没有颁发者证书（断链）或者你自己本身就是自签名证书（自己做CA，但是要记得，人家电脑上并没有装你的自签名根证书），<br>那么浏览器会报警提示不能验证证书，问你是否还需要继续。</p>
</blockquote>
<h1 id="对比HTTP和HTTPS的传输"><a href="#对比HTTP和HTTPS的传输" class="headerlink" title="对比HTTP和HTTPS的传输"></a>对比HTTP和HTTPS的传输</h1><p><img src="/img/https传输.png" alt=""></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="https://www.jianshu.com/p/116ebf3034d9" target="_blank" rel="noopener">简书 OKHttp源码解析(二)：”前戏”——HTTP的那些事</a></li>
<li><a href="https://blog.csdn.net/jlin991/article/details/59110060" target="_blank" rel="noopener">CSDN博客 HTTPS/数字证书/数字签名</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/">http</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/https/">https</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-一次完整的http请求过程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/10/11/一次完整的http请求过程/" class="article-date">
      <time datetime="2019-10-11T01:33:01.000Z" itemprop="datePublished">2019-10-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/11/一次完整的http请求过程/">一次完整的http请求过程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <h1 id="一次完整的http请求过程"><a href="#一次完整的http请求过程" class="headerlink" title="一次完整的http请求过程"></a>一次完整的http请求过程</h1><p>当我们在web浏览器的地址栏中输入： <a href="http://www.google.com，然后回车，到底发生了什么？" target="_blank" rel="noopener">www.google.com，然后回车，到底发生了什么？</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/">http</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/https/">https</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/">web</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a  href="/2019/10/11/一次完整的http请求过程/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-RServe高级配置2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/22/RServe高级配置2/" class="article-date">
      <time datetime="2018-11-22T01:50:35.000Z" itemprop="datePublished">2018-11-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/22/RServe高级配置2/">RServe安装配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="RServe高级配置"><a href="#RServe高级配置" class="headerlink" title="RServe高级配置"></a>RServe高级配置</h1><p>##　1.RServe服务器启动</p>
<p>1） 在程序中，启动RServe服务器<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> library(Rserve)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> Rserve()</span></span><br></pre></td></tr></table></figure></p>
<p>2) 在命令行，启动RServe服务器<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">~ R CMD Rserve --help</span><br><span class="line"></span><br><span class="line">Usage: R CMD Rserve [&lt;options&gt;]</span><br><span class="line"></span><br><span class="line">Options: --help  this help screen</span><br><span class="line"> --version  prints Rserve version (also passed <span class="keyword">to</span> R)</span><br><span class="line"> --RS-port &lt;port&gt;  listen on the specified TCP port</span><br><span class="line"> --RS-socket &lt;socket&gt;  use specified local (unix) socket instead of TCP/IP.</span><br><span class="line"> --RS-workdir &lt;path&gt;  use specified working directory root <span class="keyword">for</span> connections.</span><br><span class="line"> --RS-encoding &lt;enc&gt;  <span class="builtin-name">set</span><span class="built_in"> default server </span>string encoding <span class="keyword">to</span> &lt;enc&gt;.</span><br><span class="line"> --RS-conf &lt;file&gt;  load additional<span class="built_in"> config </span>file.</span><br><span class="line"> --RS-settings  dumps current<span class="built_in"> settings </span>of the Rserve</span><br><span class="line"> --RS-source &lt;file&gt;  source the specified file on startup.</span><br><span class="line"> --RS-enable-control  <span class="builtin-name">enable</span> control commands</span><br><span class="line"> --RS-enable-remote  <span class="builtin-name">enable</span> remote connections</span><br><span class="line"> --RS-pidfile &lt;file&gt;  store the pid of the Rserve process <span class="keyword">in</span> &lt;file&gt;</span><br><span class="line"> --RS-<span class="builtin-name">set</span> &lt;config&gt;=&lt;value&gt;   <span class="builtin-name">set</span> configuration option as <span class="keyword">if</span> it was</span><br><span class="line">                             read <span class="keyword">from</span> a configuration file</span><br><span class="line"></span><br><span class="line">All other options are passed <span class="keyword">to</span> the R engine.</span><br></pre></td></tr></table></figure></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">~ R <span class="keyword">CMD</span><span class="bash"> Rserve --RS-enable-remote</span></span><br></pre></td></tr></table></figure>
<h2 id="查看Rserve进程"><a href="#查看Rserve进程" class="headerlink" title="查看Rserve进程"></a>查看Rserve进程</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~ ps -aux|grep Rserve</span><br><span class="line">conan    <span class="number">27639</span>  <span class="number">0.0</span>  <span class="number">1.2</span> <span class="number">116288</span> <span class="number">25236</span> ?        Ss   <span class="number">20</span>:<span class="number">41</span>   <span class="number">0</span>:<span class="number">00</span> /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">R</span>/<span class="title">bin</span>/<span class="title">Rserve</span> --<span class="title">RS</span>-<span class="title">enable</span>-<span class="title">remote</span></span></span><br><span class="line"></span><br><span class="line">~ netstat -nltp|grep Rserve</span><br><span class="line">tcp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">6311</span>            <span class="number">0.0</span>.<span class="number">0.0</span>:*               LISTEN      <span class="number">27639</span>/Rserve</span><br></pre></td></tr></table></figure>
<h2 id="2-Rserve配置"><a href="#2-Rserve配置" class="headerlink" title="2. Rserve配置"></a>2. Rserve配置</h2><p>通过配置文件，管理Rserve服务器。</p>
<p>Rserv.conf: 配置文件<br>source.R:初始化脚步文件<br>查看当前的Rserve 服务器的默认配置信息</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~ R CMD Rserve --RS-settings</span><br><span class="line">Rserve v1.7-1</span><br><span class="line"></span><br><span class="line">config file: /etc/Rserv.conf</span><br><span class="line">working root: /tmp/Rserv</span><br><span class="line">port: 6311</span><br><span class="line">local socket: [none, TCP<span class="built_in">/IP </span>used]</span><br><span class="line">authorization required: <span class="literal">no</span></span><br><span class="line">plain text password: <span class="keyword">not</span> allowed</span><br><span class="line">passwords file: [none]</span><br><span class="line">allow I/O: <span class="literal">yes</span></span><br><span class="line">allow remote access: <span class="literal">no</span></span><br><span class="line">control commands: <span class="literal">no</span></span><br><span class="line">interactive: <span class="literal">yes</span></span><br><span class="line">max.input buffer size: 262144 kB</span><br></pre></td></tr></table></figure>
<p>修改默认配置，新建文件：/etc/Rserv.conf<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">~ sudo vi /etc/Rserv.conf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  workdir /tmp/Rserv</span><br><span class="line">  remote enable</span><br><span class="line">  fileio enable</span><br><span class="line">  interactive <span class="literal">yes</span></span><br><span class="line"> <span class="built_in"> port </span>6311</span><br><span class="line">  maxinbuf 262144</span><br><span class="line">  encoding utf8</span><br><span class="line">  control enable</span><br><span class="line">  source /home/jiaxf/R/RServe/source.R</span><br><span class="line">  eval <span class="attribute">xx</span>=1</span><br><span class="line"></span><br><span class="line">  ~ vi /home/jiaxf/R/RServe/source.R</span><br><span class="line"></span><br><span class="line">    cat(<span class="string">"This is my Rserve!!"</span>)</span><br><span class="line">    <span class="builtin-name">print</span>(paste(<span class="string">"Server start at"</span>,Sys.time()))</span><br></pre></td></tr></table></figure></p>
<p>source选项，用来配置Rserve服务器启动时加载的文件，例如：初始化系统变量，初始化系统函数等。</p>
<p>eval选项，直接定义环境变量。</p>
<p>##　4. Rserve高级使用：用户登陆认证</p>
<p>增加用户登陆认证，修改文件：/etc/Rserv.conf<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~ sudo vi /etc/Rserv.conf</span><br><span class="line"></span><br><span class="line">workdir /tmp/Rserv</span><br><span class="line">remote enable</span><br><span class="line">fileio enable</span><br><span class="line">interactive <span class="literal">yes</span></span><br><span class="line">port 6311</span><br><span class="line">maxinbuf 262144</span><br><span class="line">encoding utf8</span><br><span class="line">control enable</span><br><span class="line">source /home/jiaxf/R/RServe/source.R</span><br><span class="line">eval <span class="attribute">xx</span>=1</span><br><span class="line">auth required</span><br><span class="line">plaintext enable</span><br></pre></td></tr></table></figure></p>
<p>用RSclient登陆</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> library(RSclient)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> conn&lt;-RS.connect()</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> RS.login(conn,<span class="string">"jiaxf"</span>,<span class="string">"jiaxf"</span>,authkey=RS.authkey(conn))</span></span><br><span class="line">[1] TRUE</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-RServe安装配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/22/RServe安装配置/" class="article-date">
      <time datetime="2018-11-22T01:07:04.000Z" itemprop="datePublished">2018-11-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/22/RServe安装配置/">RServe安装配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="RServe安装配置"><a href="#RServe安装配置" class="headerlink" title="RServe安装配置"></a>RServe安装配置</h1><ol>
<li>Rserve的安装与配置<br>Rserve主要是提供远程连接的服务，当然功能是很多的，具体可参考：<a href="https://rforge.net/Rserve/" target="_blank" rel="noopener">https://rforge.net/Rserve/</a></li>
</ol>
<p>在安装Rserve之前确保R能够正常运行，并正确配置了R的环境变量。 建议安装R 3.2.5 以上的R版本。</p>
<h2 id="运行R，安装Rserve包"><a href="#运行R，安装Rserve包" class="headerlink" title="运行R，安装Rserve包"></a>运行R，安装Rserve包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~ sudo R</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> install.packages(<span class="string">"Rserve"</span>)</span></span><br></pre></td></tr></table></figure>
<h2 id="查看Rserve配置"><a href="#查看Rserve配置" class="headerlink" title="查看Rserve配置"></a>查看Rserve配置</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~ R CMD Rserve --RS-settings</span><br><span class="line">Rserve v1.7-3</span><br><span class="line"></span><br><span class="line">config file: /etc/Rserv.conf</span><br><span class="line">working root: /tmp/Rserv</span><br><span class="line">port: 6311</span><br><span class="line">local socket: [none, TCP<span class="built_in">/IP </span>used]</span><br><span class="line">authorization required: <span class="literal">no</span></span><br><span class="line">plain text password: <span class="keyword">not</span> allowed</span><br><span class="line">passwords file: [none]</span><br><span class="line">allow I/O: <span class="literal">yes</span></span><br><span class="line">allow remote access: <span class="literal">no</span></span><br><span class="line">control commands: <span class="literal">no</span></span><br><span class="line">interactive: <span class="literal">yes</span></span><br><span class="line">max.input buffer size: 262144 kB</span><br></pre></td></tr></table></figure>
<pre><code>config file: 本地无此文件/etc/Rserv.conf
working root: R运行时工作目录 /tmp/Rserv
port: 端口6311
local socket: TCP/IP协议
authorization: 认证未开启
plain text password: 不允许明文密码
passwords file: 密码文件，未指定
allow I/O: 允许IO操作
allow remote access: 远程访问未开启
control commands: 命令控制未开启
interactive: 允许通信
max.input buffer size: 文件上传限制262mb
</code></pre><h2 id="创建配置文件"><a href="#创建配置文件" class="headerlink" title="创建配置文件"></a>创建配置文件</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ sudo <span class="keyword">vi</span> /etc/Rserv.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<pre><code>workdir /tmp/Rserv
remote enable
fileio enable
auth required
plaintext enable
fileio enable
interactive yes
port 6311
maxinbuf 262144
encoding utf8
control enable
</code></pre><h2 id="开启远程访问权限后配置信息"><a href="#开启远程访问权限后配置信息" class="headerlink" title="开启远程访问权限后配置信息"></a>开启远程访问权限后配置信息</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">~ R CMD Rserve --RS-settings</span><br><span class="line">Rserve v1.7-3</span><br><span class="line"></span><br><span class="line">config file: /etc/Rserv.conf</span><br><span class="line">working root: /tmp/Rserv</span><br><span class="line">port: 6311</span><br><span class="line">local socket: [none, TCP<span class="built_in">/IP </span>used]</span><br><span class="line">authorization required: <span class="literal">yes</span></span><br><span class="line">plain text password: allowed</span><br><span class="line">passwords file: [none]</span><br><span class="line">allow I/O: <span class="literal">yes</span></span><br><span class="line">allow remote access: <span class="literal">yes</span></span><br><span class="line">control commands: <span class="literal">yes</span></span><br><span class="line">interactive: <span class="literal">yes</span></span><br><span class="line">max.input buffer size: 262144 kB</span><br></pre></td></tr></table></figure>
<h2 id="指定配置文件"><a href="#指定配置文件" class="headerlink" title="指定配置文件"></a>指定配置文件</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ R <span class="keyword">CMD</span><span class="bash"> Rserve --RS-conf /etc/Rserv.conf</span></span><br></pre></td></tr></table></figure>
<h2 id="启动Rserve远程模式"><a href="#启动Rserve远程模式" class="headerlink" title="启动Rserve远程模式"></a>启动Rserve远程模式</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ R <span class="keyword">CMD</span><span class="bash"> Rserve --RS-enable-remote</span></span><br></pre></td></tr></table></figure>
<h2 id="查看启动后Rserve端口"><a href="#查看启动后Rserve端口" class="headerlink" title="查看启动后Rserve端口"></a>查看启动后Rserve端口</h2><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ netstat -nltp|<span class="type">grep</span> Rserve</span><br></pre></td></tr></table></figure>
<blockquote>
<p>tcp  0   0 0.0.0.0:6311   0.0.0.0:*   LISTEN  73821/Rserve</p>
<p>0.0.0.0:6311 代表不受限的IP访问</p>
</blockquote>
<ol start="2">
<li>Java远程连接Rserve</li>
</ol>
<p>首先，我们需要下载Rserve所使用到的两个Jar包：REngine.jar和RserveEngine.jar，下载地址<a href="http://www.rforge.net/Rserve/files/" target="_blank" rel="noopener">http://www.rforge.net/Rserve/files/</a><br>如果项目使用maven进行管理，那么将下面的内容放入pom.xml文件中：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.rosuda.REngine<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>REngine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.rosuda.REngine<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Rserve<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">```</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-R语言初步" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/11/20/R语言初步/" class="article-date">
      <time datetime="2018-11-20T05:20:07.000Z" itemprop="datePublished">2018-11-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/20/R语言初步/">R语言初步</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="R语言初步"><a href="#R语言初步" class="headerlink" title="R语言初步"></a>R语言初步</h1><p>常用R对象</p>
<ul>
<li>向量</li>
<li>列表</li>
<li>矩阵</li>
<li>数组</li>
<li>因子</li>
<li>数据帧</li>
</ul>
<p>向量对象有六种数据类型的原子向量，也称为六类向量。 其他R对象是建立在原子向量之上的。六类向量类型如下表所示</p>
<p><img src="/img/R1.png" alt=""></p>
<h2 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h2><p>当要创建具有多个元素的向量时，应该使用<code>c()</code>函数，表示将元素组合成一个向量。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a vector.</span></span><br><span class="line">apple &lt;- c(<span class="string">'red'</span>,<span class="string">'green'</span>,<span class="string">"yellow"</span>);</span><br><span class="line"><span class="built_in">print</span>(apple);</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the class of the vector.</span></span><br><span class="line"><span class="built_in">print</span>(<span class="class"><span class="keyword">class</span>(<span class="title">apple</span>));</span></span><br></pre></td></tr></table></figure>
<p>R上面示例代码，执行结果如下<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> apple &lt;- c(<span class="string">'red'</span>,<span class="string">'green'</span>,<span class="string">"yellow"</span>);</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">print</span>(apple);</span></span><br><span class="line">[1] "red"    "green"  "yellow"</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">print</span>(class(apple));</span></span><br><span class="line">[1] "character"</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure></p>
<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><p>列表是一个R对象，它可以包含许多不同类型的元素，如向量，函数，甚至其中的另一个列表。<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Create a <span class="type">list</span>.</span><br><span class="line">list1 &lt;- <span class="type">list</span>(c(<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>),<span class="number">21.3</span>,sin);</span><br><span class="line"></span><br><span class="line"># Print the <span class="type">list</span>.</span><br><span class="line">print(list1);</span><br></pre></td></tr></table></figure></p>
<p>R上面示例代码，执行结果如下<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[[1]]</span></span><br><span class="line">[<span class="number">1</span>] <span class="number">2</span> <span class="number">5</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="string">[[2]]</span></span><br><span class="line">[<span class="number">1</span>] <span class="number">21.3</span></span><br><span class="line"></span><br><span class="line"><span class="string">[[3]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">(x)</span></span>  .Primitive(<span class="string">"sin"</span>)</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/R/">R</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Let&#39;s Encrypt通配符证书开启HTTPS" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/06/12/Let's Encrypt通配符证书开启HTTPS/" class="article-date">
      <time datetime="2018-06-12T07:50:50.000Z" itemprop="datePublished">2018-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/12/Let's Encrypt通配符证书开启HTTPS/">Let&#39;s Encrypt通配符证书开启HTTPS</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Let’s-Encrypt通配符证书开启HTTPS"><a href="#Let’s-Encrypt通配符证书开启HTTPS" class="headerlink" title="Let’s Encrypt通配符证书开启HTTPS"></a>Let’s Encrypt通配符证书开启HTTPS</h1><h2 id="什么是Let’s-Encrypt"><a href="#什么是Let’s-Encrypt" class="headerlink" title="什么是Let’s Encrypt?"></a>什么是Let’s Encrypt?</h2><p>部署 HTTPS 网站的时候需要证书，证书由 CA 机构签发，大部分传统 CA 机构签发证书是需要收费的，这不利于推动 HTTPS 协议的使用。</p>
<p>Let’s Encrypt 也是一个 CA 机构，但这个 CA 机构是免费的！也就是说签发证书不需要任何费用。</p>
<h2 id="什么是通配符证书"><a href="#什么是通配符证书" class="headerlink" title="什么是通配符证书"></a>什么是通配符证书</h2><p>在没有出现通配符证书之前，Let’s Encrypt 支持两种证书。</p>
<p>1）单域名证书：证书仅仅包含一个主机。</p>
<p>2）SAN 证书：一张证书可以包括多个主机（Let’s Encrypt 限制是 20），也就是证书可以包含下列的主机：<a href="http://www.example.com、www.example.cn、blog.example.com" target="_blank" rel="noopener">www.example.com、www.example.cn、blog.example.com</a> 等等。</p>
<p>证书包含的主机可以不是同一个注册域，不要问我注册域是什么？注册域就是向域名注册商购买的域名。</p>
<p>对于个人用户来说，由于主机并不是太多，所以使用 SAN 证书完全没有问题，但是对于大公司来说有一些问题：</p>
<p>子域名非常多，而且过一段时间可能就要使用一个新的主机。</p>
<p>注册域也非常多。</p>
<p>读者可以思考下，对于大企业来说，SAN 证书可能并不能满足需求，类似于 sina 这样的网站，所有的主机全部包含在一张证书中，而使用 Let’s Encrypt 证书是无法满足的。</p>
<h2 id="Let’s-Encrypt-通配符证书"><a href="#Let’s-Encrypt-通配符证书" class="headerlink" title="Let’s Encrypt 通配符证书"></a>Let’s Encrypt 通配符证书</h2><p>通配符证书就是证书中可以包含一个通配符，比如 .example.com、.example.cn，读者很快明白，大型企业也可以使用通配符证书了，一张证书可以防止更多的主机了。</p>
<p>这个功能可以说非常重要，从功能上看 Let’s Encrypt 和传统 CA 机构没有什么区别了，会不会触动传统 CA 机构的利益呢？</p>
<h2 id="如何申请Let’s-Encrypt通配符证书"><a href="#如何申请Let’s-Encrypt通配符证书" class="headerlink" title="如何申请Let’s Encrypt通配符证书"></a>如何申请Let’s Encrypt通配符证书</h2><p>为了实现通配符证书，Let’s Encrypt 对 ACME 协议的实现进行了升级，只有 v2 协议才能支持通配符证书。</p>
<p>也就是说任何客户端只要支持 ACME v2 版本，就可以申请通配符证书了，是不是很激动。</p>
<p>读者可以查看下自己惯用的客户端是不是支持 ACME v2 版本，官方介绍 Certbot 0.22.0 版本支持新的协议版本，我立刻进行了升级：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">./certbot-auto -V</span><br><span class="line">Upgrading certbot-auto <span class="number">0.21</span><span class="number">.1</span> to <span class="number">0.22</span><span class="number">.0</span>...</span><br><span class="line">Replacing certbot-auto...</span><br><span class="line"></span><br><span class="line">./certbot-auto -V</span><br><span class="line">certbot <span class="number">0.22</span><span class="number">.0</span></span><br></pre></td></tr></table></figure></p>
<p>在了解该协议之前有几个注意点：</p>
<p>1）客户在申请 Let’s Encrypt 证书的时候，需要校验域名的所有权，证明操作者有权利为该域名申请证书，目前支持三种验证方式：</p>
<p>dns-01：给域名添加一个 DNS TXT 记录。</p>
<p>http-01：在域名对应的 Web 服务器下放置一个 HTTP well-known URL 资源文件。</p>
<p>tls-sni-01：在域名对应的 Web 服务器下放置一个 HTTPS well-known URL 资源文件。</p>
<p>而申请通配符证书，只能使用 dns-01 的方式。</p>
<p>2）ACME v2 和 v1 协议是互相不兼容的，为了使用 v2 版本，客户端需要创建另外一个账户（代表客户端操作者），以 Certbot 客户端为例，大家可以查看：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ tree /etc/letsencrypt/accounts</span><br><span class="line">.</span><br><span class="line">├── acme-staging<span class="selector-class">.api</span><span class="selector-class">.letsencrypt</span><span class="selector-class">.org</span></span><br><span class="line">└── acme-v01<span class="selector-class">.api</span><span class="selector-class">.letsencrypt</span><span class="selector-class">.org</span></span><br></pre></td></tr></table></figure></p>
<p>3）Enumerable Orders 和限制</p>
<p>为了实现通配符证书，Let’s Encrypt 在申请者身份校验上做了很大的改变。</p>
<p>有了订单 ID 的概念，主要是为了追踪通配符域名。</p>
<p>申请限制，在 V1 版本，Let’s Encrypt 为了避免滥操作，对申请证书有一些限制（很难学习，但是正常使用不会遇到该限制）。而 v2 版本，对于通配符证书，多了一个限制，New Orders per Account（每个证书订单数限制）。</p>
<p>这两个细节，后续再仔细研究。</p>
<h2 id="实践测试"><a href="#实践测试" class="headerlink" title="实践测试"></a>实践测试</h2><p>我迫不及待想使用 Certbot 申请通配符证书，升级 Certbot 版本运行下列命令：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ certbot-auto certonly  -d *.newyingyong.cn --manual --preferred-challenges dns</span><br><span class="line"></span><br><span class="line">Saving <span class="builtin-name">debug</span> log <span class="keyword">to</span> /var/log/letsencrypt/letsencrypt.log</span><br><span class="line">Plugins selected: Authenticator manual, Installer None</span><br><span class="line">Obtaining a new certificate</span><br><span class="line">The currently selected ACME CA endpoint does <span class="keyword">not</span> support issuing wildcard certificates.</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<p>certonly，插件，Certbot 有很多插件，不同的插件都可以申请证书，用户可以根据需要自行选择<br>-d 为那些主机申请证书，如果是通配符，输入 *.newyingyong.cn<br>–preferred-challenges dns，使用 DNS 方式校验域名所有权<br>接下去就是命令行的输出：</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Saving debug log <span class="keyword">to</span> /var/log/letsencrypt/letsencrypt.log</span><br><span class="line">Plugins selected: Authenticator manual, Installer None</span><br><span class="line">Enter email address (used <span class="keyword">for</span> urgent renewal <span class="keyword">and</span> security notices) (Enter <span class="symbol">'c</span>' <span class="keyword">to</span></span><br><span class="line">cancel): ywdblog@gmail.com</span><br><span class="line"></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------</span></span><br><span class="line">Please read the Terms <span class="keyword">of</span> Service at</span><br><span class="line">https://letsencrypt.org/documents/LE-SA-v1.<span class="number">2</span>-November-<span class="number">15</span>-<span class="number">2017</span>.pdf. You must</span><br><span class="line">agree <span class="keyword">in</span> order <span class="keyword">to</span> <span class="keyword">register</span> <span class="keyword">with</span> the ACME server at</span><br><span class="line">https://acme-v02.api.letsencrypt.org/directory</span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------</span></span><br><span class="line">(A)gree/(C)ancel: A</span><br><span class="line"></span><br><span class="line">Plugins selected: Authenticator manual, Installer None</span><br><span class="line">Obtaining a <span class="keyword">new</span> certificate</span><br><span class="line">Performing the following challenges:</span><br><span class="line">dns-<span class="number">01</span> challenge <span class="keyword">for</span> newyingyong.cn</span><br><span class="line"></span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="literal">NOTE</span>: The IP <span class="keyword">of</span> this machine will be publicly logged as having requested this</span><br><span class="line">certificate. <span class="keyword">If</span> you<span class="symbol">'re</span> running certbot <span class="keyword">in</span> manual mode <span class="keyword">on</span> a machine that <span class="keyword">is</span> <span class="keyword">not</span></span><br><span class="line">your server, please ensure you<span class="symbol">'re</span> okay <span class="keyword">with</span> that.</span><br><span class="line"></span><br><span class="line">Are you OK <span class="keyword">with</span> your IP being logged?</span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------</span></span><br><span class="line">(Y)es/(N)o: y</span><br></pre></td></tr></table></figure>
<p>上述有两个交互式的提示：</p>
<p>是否同意 Let’s Encrypt 协议要求</p>
<p>询问是否对域名和机器（IP）进行绑定</p>
<p>确认同意才能继续。</p>
<p>继续查看命令行的输出，非常关键：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Please deploy a<span class="built_in"> DNS </span>TXT record under the name</span><br><span class="line">_acme-challenge.newyingyong.cn with the following value:</span><br><span class="line"></span><br><span class="line">2_8KBE_jXH8nYZ2unEViIbW52LhIqxkg6i9mcwsRvhQ</span><br><span class="line"></span><br><span class="line">Before continuing, verify the record is deployed.</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Press Enter <span class="keyword">to</span> Continue</span><br><span class="line">Waiting <span class="keyword">for</span> verification<span class="built_in">..</span>.</span><br><span class="line">Cleaning up challenges</span><br></pre></td></tr></table></figure>
<p>要求配置 DNS TXT 记录，从而校验域名所有权，也就是判断证书申请者是否有域名的所有权。</p>
<p>上面输出要求给 _acme-challenge.newyingyong.cn 配置一条 TXT 记录，在没有确认 TXT 记录生效之前不要回车执行。</p>
<p>我使用的是阿里云的域名服务器，登录控制台操作如下图：</p>
<p><img src="/img/alidns.png" alt=""></p>
<p>然后输入下列命令确认 TXT 记录是否生效：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ dig  -t txt  _acme-challenge.newyingyong.cn @<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>    </span><br><span class="line"></span><br><span class="line">;; OPT <span class="string">PSEUDOSECTION:</span></span><br><span class="line">; <span class="string">EDNS:</span> <span class="string">version:</span> <span class="number">0</span>, <span class="string">flags:</span>; <span class="string">udp:</span> <span class="number">512</span></span><br><span class="line">;; QUESTION <span class="string">SECTION:</span></span><br><span class="line">;_acme-challenge.newyingyong.cn.        IN      TXT</span><br><span class="line"></span><br><span class="line">;; ANSWER <span class="string">SECTION:</span></span><br><span class="line">_acme-challenge.newyingyong.cn. <span class="number">599</span> IN  TXT     <span class="string">"2_8KBE_jXH8nYZ2unEViIbW52LhIqxkg6i9mcwsRvhQ"</span></span><br></pre></td></tr></table></figure>
<p>确认生效后，回车执行，输出如下：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">IMPORTANT <span class="string">NOTES:</span></span><br><span class="line"> - Congratulations! Your certificate and chain have been saved <span class="string">at:</span></span><br><span class="line">   <span class="regexp">/etc/</span>letsencrypt<span class="regexp">/live/</span>newyingyong.cn/fullchain.pem</span><br><span class="line">   Your key file has been saved <span class="string">at:</span></span><br><span class="line">   <span class="regexp">/etc/</span>letsencrypt<span class="regexp">/live/</span>newyingyong.cn/privkey.pem</span><br><span class="line">   Your cert will expire on <span class="number">2018</span><span class="number">-06</span><span class="number">-12.</span> To obtain a <span class="keyword">new</span> or tweaked</span><br><span class="line">   version of <span class="keyword">this</span> certificate <span class="keyword">in</span> the future, simply run certbot-auto</span><br><span class="line">   again. To non-interactively renew *all* of your certificates, run</span><br><span class="line">   <span class="string">"certbot-auto renew"</span></span><br><span class="line"> - If you like Certbot, please consider supporting our work <span class="string">by:</span></span><br><span class="line"></span><br><span class="line">   Donating to ISRG <span class="regexp">/ Let's Encrypt:   https:/</span><span class="regexp">/letsencrypt.org/</span>donate</span><br><span class="line">   Donating to <span class="string">EFF:</span>                    <span class="string">https:</span><span class="comment">//eff.org/donate-le</span></span><br></pre></td></tr></table></figure>
<p>恭喜您，证书申请成功，证书和密钥保存在下列目录：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ tree /etc/letsencrypt/archive/newyingyong.cn</span><br><span class="line">.</span><br><span class="line">├── cert1.pem</span><br><span class="line">├── chain1.pem</span><br><span class="line">├── fullchain1.pem</span><br><span class="line">└── privkey1.pem</span><br></pre></td></tr></table></figure>
<p>然后校验证书信息，输入如下命令：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -<span class="keyword">in</span>  <span class="regexp">/etc/</span>letsencrypt<span class="regexp">/archive/</span>newyingyong.cn<span class="regexp">/cert1.pem -noout -text</span></span><br></pre></td></tr></table></figure></p>
<p>关键输出如下：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Authority Information <span class="string">Access:</span></span><br><span class="line">        OCSP - <span class="string">URI:</span><span class="string">http:</span><span class="comment">//ocsp.int-x3.letsencrypt.org</span></span><br><span class="line">        CA Issuers - <span class="string">URI:</span><span class="string">http:</span><span class="comment">//cert.int-x3.letsencrypt.org/</span></span><br><span class="line"></span><br><span class="line">X509v3 Subject Alternative <span class="string">Name:</span></span><br><span class="line"><span class="symbol">    DNS:</span>*.newyingyong.cn</span><br></pre></td></tr></table></figure></p>
<p>完美，证书包含了 SAN 扩展，该扩展的值就是 *.newyingyong.cn。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Let-s-Encrypt/">Let's Encrypt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/https/">https</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-获取Let&#39;sEncrypt免费证书" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/06/12/获取Let'sEncrypt免费证书/" class="article-date">
      <time datetime="2018-06-12T07:19:50.000Z" itemprop="datePublished">2018-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/12/获取Let'sEncrypt免费证书/">获取Let&#39;s Encrypt免费通配符证书实现Https</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="获取Let’s-Encrypt免费通配符证书实现Https"><a href="#获取Let’s-Encrypt免费通配符证书实现Https" class="headerlink" title="获取Let’s Encrypt免费通配符证书实现Https"></a>获取Let’s Encrypt免费通配符证书实现Https</h1><p>3月14日，Let’s Encrypt的执行董事Josh Aas对外宣布，他们的通配符证书正式上线，用户可以基于此特性轻松部署/开启所有子域名的HTTPS功能。</p>
<p>Let’s Encrypt 是国外一个公共的免费SSL项目，由 Linux 基金会托管，它的来头不小，由 Mozilla、思科、Akamai、IdenTrust 和 EFF 等组织发起，目的就是向网站自动签发和管理免费证书，以便加速互联网由 HTTP 过渡到 HTTPS，目前 Facebook 等大公司开始加入赞助行列。</p>
<p>Let’s Encrypt 已经得了 IdenTrust 的交叉签名，这意味着其证书现在已经可以被 Mozilla、Google、Microsoft 和 Apple 等主流的浏览器所信任，用户只需要在 Web 服务器证书链中配置交叉签名，浏览器客户端会自动处理好其它的一切，Let’s Encrypt 安装简单，使用非常方便。</p>
<h2 id="Linux下获取证书生成工具certbot"><a href="#Linux下获取证书生成工具certbot" class="headerlink" title="Linux下获取证书生成工具certbot"></a>Linux下获取证书生成工具certbot</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//dl.eff.org/certbot-auto</span></span><br><span class="line">chmod a+x certbot-<span class="keyword">auto</span></span><br></pre></td></tr></table></figure>
<h2 id="获取证书"><a href="#获取证书" class="headerlink" title="获取证书"></a>获取证书</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell <span class="string">./certbot-auto</span> certonly -d *.你的域名 <span class="params">--manual</span> <span class="params">--preferred-challenges</span> dns <span class="params">--server</span> https:<span class="string">//acme-v02.api.letsencrypt.org/directory</span></span><br></pre></td></tr></table></figure>
<p>上述有三个交互式的提示：</p>
<p>是否同意 Let’s Encrypt 协议要求<br>询问是否对域名和机器（IP）进行绑定<br>输入邮箱，给你发送一封验证邮件<br>确认同意才能继续。</p>
<p>继续查看命令行的输出，非常关键：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Please deploy a<span class="built_in"> DNS </span>TXT record under the name</span><br><span class="line">_acme-challenge.xxx.cn with the following value:</span><br><span class="line"></span><br><span class="line">2_8KBE_jXH8nYZ2unEViIbW52LhIqxkg6i9mcwsRvhQ</span><br><span class="line"></span><br><span class="line">Before continuing, verify the record is deployed.</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Press Enter <span class="keyword">to</span> Continue</span><br><span class="line">Waiting <span class="keyword">for</span> verification<span class="built_in">..</span>.</span><br><span class="line">Cleaning up challenges</span><br></pre></td></tr></table></figure>
<p>要求给 _acme-challenge.xxx.cn 配置一条 TXT 记录，在没有确认 TXT 记录生效之前不要回车执行。</p>
<p>然后输入下列命令确认 TXT 记录是否生效：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ dig  -t txt  _acme-challenge.xxx.cn @<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>    </span><br><span class="line"></span><br><span class="line">;; OPT <span class="string">PSEUDOSECTION:</span></span><br><span class="line">; <span class="string">EDNS:</span> <span class="string">version:</span> <span class="number">0</span>, <span class="string">flags:</span>; <span class="string">udp:</span> <span class="number">512</span></span><br><span class="line">;; QUESTION <span class="string">SECTION:</span></span><br><span class="line">;_acme-challenge.xxx.cn.        IN      TXT</span><br><span class="line"></span><br><span class="line">;; ANSWER <span class="string">SECTION:</span></span><br><span class="line">_acme-challenge.xxx.cn. <span class="number">599</span> IN  TXT     <span class="string">"2_8KBE_jXH8nYZ2unEViIbW52LhIqxkg6i9mcwsRvhQ"</span></span><br></pre></td></tr></table></figure>
<p>确认生效后，回车执行</p>
<p>恭喜您，证书申请成功，证书和密钥保存在下列目录：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ tree /etc/letsencrypt/archive/xxx.cn</span><br><span class="line">.</span><br><span class="line">├── cert1.pem</span><br><span class="line">├── chain1.pem</span><br><span class="line">├── fullchain1.pem</span><br><span class="line">└── privkey1.pem</span><br></pre></td></tr></table></figure>
<h2 id="证书更新"><a href="#证书更新" class="headerlink" title="证书更新"></a>证书更新</h2><p>证书有效期为三个月，到期之前需要更新证书，更新流程就是重新执行一遍上面的操作，新证书会在你申请证书的日期上加三个月。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/https/">https</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Redis数据介绍与指令大全" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/24/Redis数据介绍与指令大全/" class="article-date">
      <time datetime="2018-05-24T07:41:56.000Z" itemprop="datePublished">2018-05-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/24/Redis数据介绍与指令大全/">Redis数据介绍与指令大全</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Redis数据介绍与指令大全"><a href="#Redis数据介绍与指令大全" class="headerlink" title="Redis数据介绍与指令大全"></a>Redis数据介绍与指令大全</h1><p>作为 Key-value 型数据库,Redis 也提供了键(Key)和键值(Value)的映射关系。但是,除了常规的数值或字符串,Redis 的键值还可以是以下形式之一:</p>
<ul>
<li>Lists (列表)</li>
<li>Sets (集合)</li>
<li>Sorted sets (有序集合)</li>
<li>Hashes (哈希表)</li>
</ul>
<h2 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h2><ol>
<li>取最新的n个数据，如读取作家博客最新的50篇文章，通过List实现按时间排序的数据的高效获取</li>
<li>排行榜应用，以特定条件为排序标准，将其设成sorted set 的score，进而实现高效获取</li>
<li>需要精准设定过期时间的应用，把sorted set 的 score 值设置成过期时间的时间戳,那么就可以简单地通过过期时间排序,定时清除过期数据了</li>
<li>计数器应用，Redis 的命令都是原子性的,可以轻松地利用 INCR,DECR 命令来构建计数器系统。</li>
<li>去除大量数据中的重复数据，将数据放入set中，就能实现对重复数据的排除</li>
<li>构建队列系统使用 list 可以构建队列系统,使用 sorted set 甚至可以构建有优先级的队列系统。</li>
<li>实时系统,反垃圾系统通过上面说到的 set 功能,你可以知道一个终端用户是否进行了某个操作,可以找到其操作的集合并进行分析统计对比等。</li>
<li>Pub/Sub构建实时消息系统</li>
<li>缓存</li>
</ol>
<h2 id="redis数据类型及操作详解"><a href="#redis数据类型及操作详解" class="headerlink" title="redis数据类型及操作详解"></a>redis数据类型及操作详解</h2><h3 id="1-strings类型及操作"><a href="#1-strings类型及操作" class="headerlink" title="1. strings类型及操作"></a>1. strings类型及操作</h3><p><img src="/images/string.png" alt=""></p>
<h3 id="2-hashes类型及操作"><a href="#2-hashes类型及操作" class="headerlink" title="2. hashes类型及操作"></a>2. hashes类型及操作</h3><p>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象,相较string,由于使用了zipmap而占用更少的内存</p>
<p>操作方法：</p>
<p><img src="/images/hash.png" alt=""></p>
<h3 id="3-list类型及操作"><a href="#3-list类型及操作" class="headerlink" title="3. list类型及操作"></a>3. list类型及操作</h3><p>list 底层实现是一个双向链表，最大长度为2^32,也可用作栈</p>
<p>操作方法：</p>
<p><img src="/images/list.png" alt=""></p>
<h3 id="4-set类型及操作"><a href="#4-set类型及操作" class="headerlink" title="4. set类型及操作"></a>4. set类型及操作</h3><p>set 是 string 类型的无序集合。set 元素最大可以包含(2 的 32 次方)个元素。set 的是通过 hash table 实现的，hash table 会随着添加或者删除自动的调整大小。调整 hash table 大小时候需要同步(获取写锁)会阻塞其他读写操作。</p>
<p>操作方法：</p>
<p><img src="/images/set.png" alt=""></p>
<h3 id="5-sorted-sets-类型及操作"><a href="#5-sorted-sets-类型及操作" class="headerlink" title="5. sorted sets 类型及操作"></a>5. sorted sets 类型及操作</h3><p>sorted set 在set的基础上增加了一个标识属性，它可以在set添加或修改元素时指定，每次指定，set会自动按标识调整顺序，set的每一个元素都会关联一个double类型的score。使用时往往我们把要排序的字段作为score存储，对象id则作为元素存储。</p>
<p>操作方法：</p>
<p><img src="/images/sortedset.png" alt=""></p>
<h2 id="redis-常用命令"><a href="#redis-常用命令" class="headerlink" title="redis 常用命令"></a>redis 常用命令</h2><h3 id="1-键值相关命令"><a href="#1-键值相关命令" class="headerlink" title="1. 键值相关命令"></a>1. 键值相关命令</h3><p><img src="/images/clientcmd.png" alt=""></p>
<h3 id="2-服务器相关命令"><a href="#2-服务器相关命令" class="headerlink" title="2. 服务器相关命令"></a>2. 服务器相关命令</h3><p><img src="/images/servercmd.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缓存/">缓存</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-redis常用命令总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/24/redis常用命令总结/" class="article-date">
      <time datetime="2018-05-24T07:26:22.000Z" itemprop="datePublished">2018-05-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/24/redis常用命令总结/">redis常用命令总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="redis常用命令总结"><a href="#redis常用命令总结" class="headerlink" title="redis常用命令总结"></a>redis常用命令总结</h1><h2 id="一、key-pattern-查询相应的key"><a href="#一、key-pattern-查询相应的key" class="headerlink" title="一、key pattern 查询相应的key"></a>一、key pattern 查询相应的key</h2><p>　　（1）redis允许模糊查询key　　有3个通配符  <code>*、?、[]`</code></p>
<p>　　（2）randomkey：返回随机key　　</p>
<p>　　（3）type key：返回key存储的类型</p>
<p>　　（4）exists key：判断某个key是否存在</p>
<p>　　（5）del key：删除key</p>
<p>　　（6）rename key newkey：改名</p>
<p>　　（7）renamenx key newkey：如果newkey不存在则修改成功</p>
<p>　　（8）move key 1：将key移动到1数据库</p>
<p>　　（9）ttl key：查询key的生命周期（秒）</p>
<p>　　（10）expire key 整数值：设置key的生命周期以秒为单位</p>
<p>　　（11）pexpire key 整数值：设置key的生命周期以毫秒为单位</p>
<p>　　（12）pttl key：查询key 的生命周期（毫秒）</p>
<p>　　（13）perisist key：把指定key设置为永久有效</p>
<h2 id="二、字符串类型的操作"><a href="#二、字符串类型的操作" class="headerlink" title="二、字符串类型的操作"></a>二、字符串类型的操作</h2><p>　　（1）set key value [ex 秒数] [px 毫秒数] [nx/xx]　　</p>
<p>　　　　　　如果ex和px同时写，则以后面的有效期为准</p>
<p>　　　　　　nx：如果key不存在则建立</p>
<p>　　　　　　xx：如果key存在则修改其值</p>
<p>　　（2）get key：取值</p>
<p>　　（3）mset key1 value1 key2 value2 一次设置多个值</p>
<p>　　（4）mget key1 key2 ：一次获取多个值</p>
<p>　　（5）setrange key offset value：把字符串的offset偏移字节改成value</p>
<p>　　　　　　　　　　　　　　　　　　如果偏移量 &gt; 字符串长度，该字符自动补0x00</p>
<p>　　（6）append key value ：把value追加到key 的原值上</p>
<p>　　（7）getrange key start stop：获取字符串中[start, stop]范围的值</p>
<p>　　　　　　　　　　　　　　　　　　对于字符串的下标，左数从0开始，右数从-1开始</p>
<p>　　　　　　　　　　　　　　　　　　注意：当start&gt;length，则返回空字符串</p>
<p>　　　　　　　　　　　　　　　　　　　　　当stop&gt;=length，则截取至字符串尾</p>
<p>　　　　　　　　　　　　　　　　　　　　　如果start所处位置在stop右边，则返回空字符串</p>
<p>　　（8）getset key nrevalue：获取并返回旧值，在设置新值</p>
<p>　　（9）incr key：自增，返回新值，如果incr一个不是int的value则返回错误，incr一个不存在的key，则设置key为1</p>
<p>　　（10）incrby key 2：跳2自增</p>
<p>　　（11）incrbyfloat by 0.7： 自增浮点数　</p>
<p>　　（12）setbit key offset value：设置offset对应二进制上的值，返回该位上的旧值</p>
<p>注意：如果offset过大，则会在中间填充0</p>
<p>　　　offset最大到多少</p>
<p>　　　2^32-1，即可推出最大的字符串为512M</p>
<p>　　（13）bitop operation destkey key1 [key2..]    对key1 key2做opecation并将结果保存在destkey上</p>
<p>　　　　　　　　　　　　　　　　　　　　　　　　　　opecation可以是AND OR NOT XOR</p>
<p>　　（14）strlen key：取指定key的value值的长度</p>
<p>　  （15）setex key time value：设置key对应的值value，并设置有效期为time秒</p>
<h2 id="三、链表操作"><a href="#三、链表操作" class="headerlink" title="三、链表操作"></a>三、链表操作</h2><p>　　Redis的list类型其实就是一个每个子元素都是string类型的双向链表，链表的最大长度是2^32。list既可以用做栈，也可以用做队列。</p>
<p>　　list的pop操作还有阻塞版本，主要是为了避免轮询</p>
<p>　　（1）lpush key value：把值插入到链表头部</p>
<p>　　（2）rpush key value：把值插入到链表尾部</p>
<p>　　（3）lpop key ：返回并删除链表头部元素</p>
<p>　　（4）rpop key： 返回并删除链表尾部元素</p>
<p>　　（5）lrange key start stop：返回链表中[start, stop]中的元素</p>
<p>　　（6）lrem key count value：从链表中删除value值，删除count的绝对值个value后结束</p>
<p>　　　　　　　　　　　　　　　　count &gt; 0 从表头删除　　count &lt; 0 从表尾删除　　count=0 全部删除</p>
<p>　　（7）ltrim key start stop：剪切key对应的链接，切[start, stop]一段并把改制重新赋给key</p>
<p>　　（8）lindex key index：返回index索引上的值</p>
<p>　　（9）llen key：计算链表的元素个数</p>
<p>　　（10）linsert key after|before search value：在key 链表中寻找search，并在search值之前|之后插入value</p>
<p>　　（11）rpoplpush source dest：把source 的末尾拿出，放到dest头部，并返回单元值</p>
<p>　　　　应用场景： task + bak 双链表完成安全队列</p>
<p>　业务逻辑： rpoplpush task bak</p>
<p>　　　　　　　　　接收返回值并做业务处理</p>
<p>　　　　　　　　　如果成功则rpop bak清除任务，如果不成功，下次从bak表取任务</p>
<p>　　（12）brpop，blpop key timeout：等待弹出key的尾/头元素</p>
<p>　　　　　　　　　　　　　　　　timeout为等待超时时间，如果timeout为0则一直等待下去</p>
<p>　　　　　　应用场景：长轮询ajax，在线聊天时能用到</p>
<h2 id="四、hashes类型及操作"><a href="#四、hashes类型及操作" class="headerlink" title="四、hashes类型及操作"></a>四、hashes类型及操作</h2><p>　　Redis hash 是一个string类型的field和value的映射表，它的添加、删除操作都是O(1)（平均）。hash特别适用于存储对象，将一个对象存储在hash类型中会占用更少的内存，并且可以方便的存取整个对象。</p>
<p>　　配置： hash_max_zipmap_entries 64 #配置字段最多64个</p>
<p>　　　　　 hash_max_zipmap_value 512 #配置value最大为512字节</p>
<p>　　（1）hset myhash field value：设置myhash的field为value</p>
<p>　　（2）hsetnx myhash field value：不存在的情况下设置myhash的field为value</p>
<p>　　（3）hmset myhash field1 value1 field2 value2：同时设置多个field</p>
<p>　　（4）hget myhash field：获取指定的hash field</p>
<p>　　（5）hmget myhash field1 field2：一次获取多个field</p>
<p>　　（6）hincrby myhash field 5：指定的hash field加上给定的值</p>
<p>　　（7）hexists myhash field：测试指定的field是否存在</p>
<p>　　（8）hlen myhash：返回hash的field数量</p>
<p>　　（9）hdel myhash field：删除指定的field</p>
<p>　　（10）hkeys myhash：返回hash所有的field</p>
<p>　　（11）hvals myhash：返回hash所有的value</p>
<p>　　（12）hgetall myhash：获取某个hash中全部的field及value　</p>
<p>##　五、集合结构操作</p>
<p>　　特点：无序性、确定性、唯一性</p>
<p>　　（1）sadd key value1 value2：往集合里面添加元素</p>
<p>　　（2）smembers key：获取集合所有的元素</p>
<p>　　（3）srem key value：删除集合某个元素</p>
<p>　　（4）spop key：返回并删除集合中1个随机元素（可以坐抽奖，不会重复抽到某人）　　　</p>
<p>　　（5）srandmember key：随机取一个元素</p>
<p>　　（6）sismember key value：判断集合是否有某个值</p>
<p>　　（7）scard key：返回集合元素的个数</p>
<p>　　（8）smove source dest value：把source的value移动到dest集合中</p>
<p>　　（9）sinter key1 key2 key3：求key1 key2 key3的交集</p>
<p>　　（10）sunion key1 key2：求key1 key2 的并集</p>
<p>　　（11）sdiff key1 key2：求key1 key2的差集</p>
<p>　　（12）sinterstore res key1 key2：求key1 key2的交集并存在res里　</p>
<h2 id="六、有序集合"><a href="#六、有序集合" class="headerlink" title="六、有序集合"></a>六、有序集合</h2><p>　　概念：它是在set的基础上增加了一个顺序属性，这一属性在添加修改元素的时候可以指定，每次指定后，zset会自动按新的值调整顺序。可以理解为有两列的mysql表，一列存储value，一列存储顺序，操作中key理解为zset的名字。</p>
<p>　　和set一样sorted，sets也是string类型元素的集合，不同的是每个元素都会关联一个double型的score。sorted set的实现是skip list和hash table的混合体。</p>
<p>　　当元素被添加到集合中时，一个元素到score的映射被添加到hash table中，所以给定一个元素获取score的开销是O(1)。另一个score到元素的映射被添加的skip list，并按照score排序，所以就可以有序地获取集合中的元素。添加、删除操作开销都是O(logN)和skip list的开销一致，redis的skip list 实现是双向链表，这样就可以逆序从尾部去元素。sorted set最经常使用方式应该就是作为索引来使用，我们可以把要排序的字段作为score存储，对象的ID当元素存储。</p>
<p>　　（1）zadd key score1 value1：添加元素</p>
<p>　　（2）zrange key start stop [withscore]：把集合排序后,返回名次[start,stop]的元素  默认是升续排列  withscores 是把score也打印出来</p>
<p>　　（3）zrank key member：查询member的排名（升序0名开始）</p>
<p>　　（4）zrangebyscore key min max [withscores] limit offset N：集合（升序）排序后取score在[min, max]内的元素，并跳过offset个，取出N个</p>
<p>　　（5）zrevrank key member：查询member排名（降序 0名开始）</p>
<p>　　（6）zremrangebyscore key min max：按照score来删除元素，删除score在[min, max]之间</p>
<p>　　（7）zrem key value1 value2：删除集合中的元素</p>
<p>　　（8）zremrangebyrank key start end：按排名删除元素，删除名次在[start, end]之间的</p>
<p>　　（9）zcard key：返回集合元素的个数</p>
<p>　　（10）zcount key min max：返回[min, max]区间内元素数量</p>
<p>　　（11）zinterstore dest numkeys key1[key2..] [WEIGHTS weight1 [weight2…]] [AGGREGATE SUM|MIN|MAX]</p>
<p>　　　　　　求key1，key2的交集，key1，key2的权值分别是weight1，weight2</p>
<p>　　　　　　聚合方法用 sum|min|max</p>
<p>　　　　　　聚合结果 保存子dest集合内</p>
<p>　　　　　　注意：weights,aggregate如何理解？</p>
<p>答：如果有交集，交集元素又有score，score怎么处理？aggregate num-&gt;score相加，min最小score，max最大score，另外可以通过weights设置不同的key的权重，交集时  score*weight</p>
<h2 id="七、服务器相关命令"><a href="#七、服务器相关命令" class="headerlink" title="七、服务器相关命令"></a>七、服务器相关命令</h2><p>　　（1）ping：测定连接是否存活</p>
<p>　　（2）echo：在命令行打印一些内容</p>
<p>　　（3）select：选择数据库</p>
<p>　　（4）quit：退出连接</p>
<p>　　（5）dbsize：返回当前数据库中key的数目</p>
<p>　　（6）info：获取服务器的信息和统计</p>
<p>　　（7）monitor：实时转储收到的请求</p>
<p>　　（8）config get 配置项：获取服务器配置的信息</p>
<p>　　　　 config set 配置项  值：设置配置项信息</p>
<p>　　（9）flushdb：删除当前选择数据库中所有的key</p>
<p>　　（10）flushall：删除所有数据库中的所有的key</p>
<p>　　（11）time：显示服务器时间，时间戳（秒），微秒数</p>
<p>　　（12）bgrewriteaof：后台保存rdb快照</p>
<p>　　（13）bgsave：后台保存rdb快照</p>
<p>　　（14）save：保存rdb快照</p>
<p>　　（15）lastsave：上次保存时间</p>
<p>　　（16）shutdown [save/nosave]</p>
<p>　　注意：如果不小心运行了flushall，立即shutdown nosave，关闭服务器，然后手工编辑aof文件，去掉文件中的flushall相关行，然后开启服务器，就可以倒回原来是数据。如果flushall之后，系统恰好bgwriteaof了，那么aof就清空了，数据丢失。</p>
<p>　　（17）showlog：显示慢查询</p>
<p>　　　　　　问：多慢才叫慢？</p>
<p>　　　　　　答：由slowlog-log-slower-than 10000，来指定（单位为微秒）</p>
<p>　　　　　　问：服务器存储多少条慢查询记录</p>
<p>　　　　　　答：由slowlog-max-len 128，来做限制　　　　　　　</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缓存/">缓存</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-redis通配符删除" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/05/24/redis通配符删除/" class="article-date">
      <time datetime="2018-05-24T07:14:45.000Z" itemprop="datePublished">2018-05-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/24/redis通配符删除/">redis通配符删除</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="redis通配符删除"><a href="#redis通配符删除" class="headerlink" title="redis通配符删除"></a>redis通配符删除</h1><h2 id="批量删除Key"><a href="#批量删除Key" class="headerlink" title="批量删除Key"></a>批量删除Key</h2><p>Redis 中有删除单个 Key 的指令 DEL，但好像没有批量删除 Key 的指令，不过我们可以借助 Linux 的 xargs 指令来完成这个动作</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-<span class="keyword">cli</span> keys <span class="string">"*"</span> | xargs redis-<span class="keyword">cli</span> del</span><br></pre></td></tr></table></figure>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果要指定 Redis 数据库访问密码，使用下面的命令</span></span><br><span class="line">redis-<span class="keyword">cli</span> -a password keys <span class="string">"*"</span> | xargs redis-<span class="keyword">cli</span> -a password del  </span><br><span class="line"></span><br><span class="line"><span class="comment">//下面的命令指定数据序号为0，即默认数据库  </span></span><br><span class="line">redis-<span class="keyword">cli</span> -<span class="keyword">n</span> 0 keys <span class="string">"*"</span> | xargs redis-<span class="keyword">cli</span> -<span class="keyword">n</span> 0 del</span><br></pre></td></tr></table></figure>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//批量删除redis 数据库中redis key的方法如下：</span></span><br><span class="line">bin/redis-cli  –h <span class="params">&lt;your_redis_server_IP&gt;</span></span><br><span class="line">                -p  <span class="number">6379</span>  -n  <span class="params">&lt;your database ID&gt;</span></span><br><span class="line">                -a  <span class="params">&lt;your_auth_keys&gt;</span>  keys  <span class="string">"mykeys*"</span>  |  xargs bin/redis-cli -n <span class="params">&lt;your database ID&gt;</span> del</span><br></pre></td></tr></table></figure>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除所有Key，可以使用Redis的flushdb和flushall命令</span></span><br><span class="line"><span class="comment">//删除当前数据库中的所有Key  </span></span><br><span class="line">flushdb  </span><br><span class="line"><span class="comment">//删除所有数据库中的key  </span></span><br><span class="line">flushall</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术/">技术</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/缓存/">缓存</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 Jiaxf
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >用户到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 30;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-70677304-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','f9SxgsuoT3T5zTyGctUR','2.0.0');
        
      }
    </script>

  </div>
</body>
</html>
<a href="https://github.com/jiaxf"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
